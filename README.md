# TabEx
Add Chrome-like tab functionality to explorer, replacing Clover and ExTab.

TabExplorer 界面布局说明
整体结构
采用经典的三段式布局：顶部菜单栏 + 左右分割视图

1. 顶部区域
菜单栏：显示所有书签，包括：
🖥️ 此电脑、🗔 桌面、🗑️ 回收站、🚀 启动项、⬇️ 下载（默认书签）
📁 书签文件夹（可展开子菜单）
📑 自定义书签
"书签管理"菜单项（最右侧）
2. 主内容区（水平分割）
左侧：目录树（200-350px 宽）
显示本地磁盘驱动器（C:、D: 等）
自动展开所有本地盘符
隐藏网络驱动器（UNC 路径）
点击目录树中的文件夹会在右侧当前标签页中打开
右侧：标签页区域
包含三个部分：

① 标签栏（顶部）

标签页列表，选中标签背景为淡黄色（#FFF9CC）
标签显示最后16个字符的路径名称
鼠标悬停在标签上时显示关闭按钮（×），悬停在按钮上变为红色圆形
支持右键菜单：固定/取消固定、添加书签
右上角导航和操作按钮（35×35px）：
  ← 后退按钮（根据历史记录状态启用/禁用）
  → 前进按钮（始终启用，无前进历史时保持当前位置）
  ➕ 新建标签页按钮
交互：
双击标签栏空白区域（标签和按钮之间）：新建标签页
双击按钮之间的空白区域：新建标签页
拖拽文件夹到标签栏：打开新标签页
② 面包屑路径栏（每个标签页内）

淡绿色背景（#e8f5e9）
显示当前路径的层级导航
每个路径段可点击跳转
支持点击切换到编辑模式，手动输入路径
支持特殊路径：shell:、网络路径（UNC）、本地路径
③ 文件浏览器（每个标签页内）

使用 Windows Shell.Explorer ActiveX 控件
完整的文件浏览功能（类似系统资源管理器）
交互：
双击空白区域：返回上一级
到达盘符根目录再返回：跳转到"此电脑"
3. 特色功能
✅ 多标签页浏览（每个标签页独立历史记录）
✅ 前进/后退导航（支持浏览历史记录）
✅ 标签页固定（带 📌 图标，开机自动恢复）
✅ 标签页拖拽排序（鼠标拖拽调整标签页顺序，固定标签保持在最左侧）
✅ 拖拽文件夹打开新标签页
✅ 书签管理（支持文件夹层级、上移/下移、编辑/删除）
✅ 面包屑导航（支持点击层级跳转、双击编辑）
✅ 网络路径支持（UNC 路径 \\server\share）
✅ 特殊 shell 路径支持（回收站、桌面、此电脑等）
✅ 左侧目录树（自动展开本地盘符，隐藏网络驱动器）
✅ 双击空白区域智能操作（标签栏空白→新建标签页，文件区空白→返回上级）
✅ **单实例模式**（右键菜单打开文件夹时在已有窗口中打开新标签页，避免启动多个进程）
✅ **强大的搜索功能**（支持文件名、文件内容、文件夹名搜索）

### 搜索功能详细说明

搜索对话框功能：
- 🔍 **文件名搜索**：搜索文件名和文件夹名（不区分大小写）
- 📝 **文件内容搜索**：搜索文件内部的文本内容
  - 小文件（≤100MB）：全文搜索
  - 大文件（>100MB）：分块读取（每块100MB），完整搜索整个文件
  - 智能重叠：防止关键词被分割遗漏
- 🪟 **非模态窗口**：搜索时不阻塞主窗口操作
- 📊 **表格化结果**：
  - **文件名列**：显示完整路径（文件不含扩展名），省略号在开头
  - **类型列**：文件扩展名（TXT、PDF等）或"文件夹"
  - **修改日期列**：YYYY-MM-DD HH:MM:SS 格式
  - **大小列**：自动格式化（B/KB/MB/GB）
- 🔄 **支持排序**：点击列标题可按任意列升序/降序排序
- 📈 **实时进度**：显示已扫描文件数和找到的结果数
- 🎯 **精准导航**：双击结果直接在新标签页打开文件夹或文件所在位置
- 🖼️ **窗口功能**：可调整大小、最大化、最小化
- 🎨 **友好界面**：
  - 📁 文件夹和 📄 文件用图标区分
  - 交替行颜色，网格线清晰
  - 灰色表头，行高优化（24px）

搜索按钮位置：标签栏右上角（后退/前进按钮旁边）

4. 单实例模式说明
当通过右键菜单或命令行打开文件夹/文件时：
- 如果已有 TabExplorer 实例运行，会自动在该实例中打开新标签页
- 已有实例会自动激活并置顶显示
- 避免启动多个 TabExplorer 进程，节省系统资源
- 使用 TCP 端口 58923 进行进程间通信

注册为右键菜单：
运行 `3_register_as_default.bat` 注册到资源管理器右键菜单（需管理员权限）
支持：
- 右键文件夹 → "open with TabExplorer"
- 右键文件 → "open with TabExplorer"（打开文件所在文件夹）
- 文件夹空白处右键 → "open TabExplorer here"
- 右键驱动器 → "open with TabExplorer"

卸载右键菜单：运行 `4_unregister.bat`

运行环境：
首次运行前需要双击 0_install_requirements.bat ， 安装必要软件。
然后双击运行 1_TabEx.bat 。

开机自启动方式：
将 1_TabEx.bat 的快捷方式放到 shell:startup 目录

我本地环境：
python 3.9.6



