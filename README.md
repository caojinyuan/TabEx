# TabEx
Add Chrome-like tab functionality to explorer, replacing Clover and ExTab.

## 📥 下载

**最新版本**: 从 [Releases](../../releases/latest) 页面下载 `TabExplorer.exe`

无需安装Python环境，下载即用！

---

## ✨ 特色功能
✅ 多标签页浏览（每个标签页独立历史记录）
✅ 前进/后退导航（支持浏览历史记录）
✅ 标签页固定（带 📌 图标，开机自动恢复）
✅ 标签页拖拽排序（鼠标拖拽调整标签页顺序，固定标签保持在最左侧）
✅ **全面拖拽支持**（支持从文件资源管理器或左侧目录树拖拽文件夹到标签栏、主窗口、目录树任意位置打开新标签页）
✅ 书签管理（支持文件夹层级、上移/下移、编辑/删除，悬停状态视觉优化）
✅ 面包屑导航（支持点击层级跳转、双击编辑）
✅ 网络路径支持（UNC 路径 \\server\share）
✅ 特殊 shell 路径支持（回收站、桌面、此电脑等）
✅ 左侧目录树（自动展开本地盘符，隐藏网络驱动器，可自由调整宽度，支持拖拽操作）
✅ 双击空白区域智能操作（标签栏空白→新建标签页，文件区空白→返回上级）
✅ **单实例模式**（右键菜单打开文件夹时在已有窗口中打开新标签页，避免启动多个进程）
✅ **强大的搜索功能**（支持文件名、文件内容、文件夹名搜索，智能二进制文件过滤，LRU缓存优化）
✅ **🆕 自动监听新Explorer窗口**（类似Clover，新打开的Windows资源管理器窗口会自动嵌入到TabExplorer的标签页中）
✅ **🆕 智能性能优化**（搜索缓存、批量UI更新、智能双击处理）

---

## 🆕 最近更新（2025-12 / 2026-01）

### 拖拽功能增强
- **全面拖拽支持**：支持从文件资源管理器拖拽文件夹到标签栏空白处、主窗口任意位置打开新标签页
- **左侧目录树拖拽**：支持从文件资源管理器拖拽文件夹到左侧目录树，自动打开新标签页
- **双向拖拽**：支持从左侧目录树拖拽文件夹到标签栏或窗口其他位置打开新标签页
- **智能路径识别**：自动识别本地路径和UNC网络路径，拖拽文件时自动打开其所在文件夹

### 界面与交互优化
- **书签栏样式优化**：修复书签菜单悬停时文字不可见的问题，增强视觉体验
- **自定义标题栏**：将"📑 书签管理""⚙️ 设置"与最小化/最大化/关闭按钮放在同一行的顶部标题栏，支持拖动与双击最大化
- **书签栏位置与高度**：书签栏固定在标题栏下方，统一高度为 28px，移除重复入口
- **弹框优化**：设置、书签管理弹框采用模态对话框并移除右上角问号按钮；设置弹框更大更舒适
- **蓝色圆角外边框**：窗口采用蓝色可见外边框（白色内容容器嵌套），更易与其他应用区分
- **无边框拖拽缩放**：支持从窗口边缘/角落拖拽调整大小；鼠标在边缘时自动显示对应的调整大小光标
- **图标支持**：运行时为应用与任务栏添加蓝白主题图标（TE字样）
- **左侧目录树优化**：移除最大宽度限制，支持自由拖动调整宽度（最小150px），支持拖拽操作

### 搜索功能增强
- **LRU搜索缓存**：最多缓存50个搜索结果，重复搜索瞬间返回
- **智能文件过滤**：自动跳过二进制文件（exe、dll、图片、视频等），只搜索文本文件内容
- **文本智能检测**：使用黑名单+智能检测，支持自定义文件格式
- **性能优化**：批量UI更新（每50ms处理200个结果），队列限制防止卡死
- **结果限制**：默认最多显示5000个结果，防止UI卡顿
- **状态实时更新**：每100个文件更新一次进度，搜索过程可视化

### 性能与稳定性优化
- **Explorer监听优化**：监听频率从500ms降至2000ms，可在设置中自定义，支持多种窗口类型（CabinetWClass、ExploreWClass）
- **智能双击处理**：使用双击ID机制和多重检查，准确区分文件夹双击和空白双击，防止误操作
- **导航优化**：使用Navigate2确保平滑导航
- **路径同步优化**：从500ms改为1000ms，减少资源占用
- **延迟保存书签**：避免频繁I/O操作

---


运行环境：
首次运行前需要双击 0_install_requirements.bat ， 安装必要软件。
然后双击运行 1_TabEx.bat 。

开机自启动方式：
将 1_TabEx.bat 的快捷方式放到 shell:startup 目录

### 🛠️ 从源码运行

在已安装依赖的情况下，可直接运行：
高级功能详解

### 自动监听Explorer窗口

**功能说明**：
类似于Clover的核心功能，TabExplorer可以自动监听系统中新打开的Windows资源管理器窗口，并将其自动嵌入到TabExplorer的标签页中。

**如何使用**：
1. 启动TabExplorer
2. 在菜单栏点击 `⚙️ 设置` → 确保 `监听新Explorer窗口` 选项已勾选（默认启用）
3. 打开任意新的Windows资源管理器窗口（比如通过Win+E快捷键，或双击文件夹）
4. 新打开的资源管理器窗口会被自动关闭，并在TabExplorer中打开一个新的标签页指向该路径

**配置选项**：
- 可以在 `config.json` 中设置 `"enable_explorer_monitor": false` 来禁用此功能
- 可以设置 `"explorer_monitor_interval": 2000` 调整监听频率（毫秒），默认2000ms
- 也可以通过菜单栏的设置选项动态启用/禁用

**工作原理**：
- 后台监听线程定期检测新打开的Explorer窗口（支持CabinetWClass和ExploreWClass窗口类）
- 通过COM接口获取新窗口的当前路径
- 智能识别窗口类型，避免误捕获软件自身窗口
- 在TabExplorer中创建新标签页并导航到该路径
- 自动关闭原Explorer窗口，实现无缝体验

### 智能搜索系统

**搜索能力**：
- **文件名搜索**：快速查找文件和文件夹
- **文件内容搜索**：全文搜索，支持大文件分块读取
- **文件类型过滤**：支持 `*.c,*.h,*.xml` 等格式过滤
- **智能二进制过滤**：自动跳过 exe、dll、图片、视频等二进制文件
- **自定义格式支持**：智能检测任意文本文件（包括无扩展名文件）

**性能优化**：
- **LRU缓存**：重复搜索立即返回结果
- **批量更新**：每50ms处理200个结果，界面流畅
- **队列保护**：限制1000个待显示结果，防止内存溢出
- **结果限制**：最多显示5000个结果，超过会有警告提示
- **进度实时显示**：每100个文件更新一次状态

**使用技巧**：
1. 搜索大量文件时，建议使用文件类型过滤
2. 只搜索文件名比搜索内容快得多
3. 搜索结果会被缓存，重复搜索秒开
4. 缓存会在应用重启时自动清空

我本地环境：
python 3.9.6




